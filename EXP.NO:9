AIM
To decrypt the PT-109 wartime radio message using the Playfair cipher and a user-supplied key.
# Playfair Cipher Decryption

def generate_matrix(key):
    key = key.upper().replace("J", "I")
    matrix = []
    used = set()

    for ch in key:
        if ch not in used and ch.isalpha():
            matrix.append(ch)
            used.add(ch)

    for ch in "ABCDEFGHIKLMNOPQRSTUVWXYZ":
        if ch not in used:
            matrix.append(ch)
            used.add(ch)

    # Convert into 5x5 matrix
    return [matrix[i:i+5] for i in range(0, 25, 5)]


def find_position(matrix, ch):
    for r in range(5):
        for c in range(5):
            if matrix[r][c] == ch:
                return r, c
    return None


def decrypt_playfair(cipher, matrix):
    cipher = cipher.replace(" ", "").upper().replace("J", "I")
    plaintext = ""

    i = 0
    while i < len(cipher):
        a = cipher[i]
        b = cipher[i+1]

        r1, c1 = find_position(matrix, a)
        r2, c2 = find_position(matrix, b)

        if r1 == r2:  # same row
            plaintext += matrix[r1][(c1 - 1) % 5]
            plaintext += matrix[r2][(c2 - 1) % 5]
        elif c1 == c2:  # same column
            plaintext += matrix[(r1 - 1) % 5][c1]
            plaintext += matrix[(r2 - 1) % 5][c2]
        else:
            plaintext += matrix[r1][c2]
            plaintext += matrix[r2][c1]

        i += 2
    return plaintext


key = input("Enter Playfair key: ")
ciphertext = input("Enter ciphertext: ")

matrix = generate_matrix(key)
plaintext = decrypt_playfair(ciphertext, matrix)

print("\nDecrypted message:", plaintext)
RESULT

The PT-109 radio message was successfully decrypted using the Playfair cipher.
