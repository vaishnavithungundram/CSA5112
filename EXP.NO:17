AIM
Show a Python implementation of DES key scheduling (PC-1 / left shifts / PC-2) and provide a function that yields the 16 decryption subkeys (i.e., the encryption subkeys in reverse order). This demonstrates how decryption uses the same schedule but reverse order.
Note: this code implements the DES key schedule (not full DES encryption). It uses standard PC-1 and PC-2 tables and shift schedule.
# des_key_schedule.py
# Generate DES subkeys and produce reversed order for decryption

PC1 = [
 57,49,41,33,25,17,9,
 1,58,50,42,34,26,18,
 10,2,59,51,43,35,27,
 19,11,3,60,52,44,36,
 63,55,47,39,31,23,15,
 7,62,54,46,38,30,22,
 14,6,61,53,45,37,29,
 21,13,5,28,20,12,4
]

PC2 = [
 14,17,11,24,1,5,
 3,28,15,6,21,10,
 23,19,12,4,26,8,
 16,7,27,20,13,2,
 41,52,31,37,47,55,
 30,40,51,45,33,48,
 44,49,39,56,34,53,
 46,42,50,36,29,32
]

# Left shifts per round
SHIFTS = [1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1]

def str_to_bitlist(hexkey):
    # expects 64-bit key as hex or 8-char string; return 64-bit list
    if len(hexkey) == 16:  # hex
        b = bin(int(hexkey,16))[2:].zfill(64)
    else:
        b = ''.join(f"{ord(c):08b}" for c in hexkey[:8])
    return [int(x) for x in b]

def permute(bits, table):
    return [bits[i-1] for i in table]

def left_rotate(lst, n):
    return lst[n:] + lst[:n]

def generate_subkeys(key64bits):
    # key64bits: list of 64 bits (parity bits included)
    key56 = permute(key64bits, PC1)  # 56 bits
    C = key56[:28]
    D = key56[28:]
    subkeys = []
    for s in SHIFTS:
        C = left_rotate(C, s)
        D = left_rotate(D, s)
        CD = C + D
        sub = permute(CD, PC2)  # 48 bits
        subkeys.append(sub)
    return subkeys

def subkeys_for_decryption(key64bits):
    enc_keys = generate_subkeys(key64bits)
    return list(reversed(enc_keys))

# Example usage
if __name__ == "__main__":
    # Example small test key (8 ASCII chars)
    key = "ABCDEFGH"  # 8 chars
    bits = str_to_bitlist(key)
    enc = generate_subkeys(bits)
    dec = subkeys_for_decryption(bits)
    print("K1 (enc):", ''.join(map(str,enc[0])))
    print("K16 (enc):", ''.join(map(str,enc[-1])))
    print("Decryption first subkey (should equal K16):", ''.join(map(str,dec[0])))
RESULT

This program correctly generates encryption subkeys (K1...K16) using PC-1, rotation schedule, and PC-2, and returns the decryption subkeys as the encryption subkeys in reverse order (K16...K1) â€” which is how DES decryption is implemented.
